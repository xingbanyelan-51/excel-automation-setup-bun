# Excel 自动化设置脚本帮助文件

## 概述

这个 PowerShell 脚本旨在帮助用户快速设置一个基于 Bun 的环境，用于处理 Excel 文件自动化任务。它会自动安装必要的依赖库，生成模板 `main.js` 文件（仅在不存在时生成），并支持通过拖拽方式交互式处理 Excel 文件。该脚本特别适合开发人员或数据爱好者，使用 JavaScript 库在命令行中读取、修改和处理 Excel 文件。

脚本的核心功能包括：
- 自动安装 Bun 和 Excel 相关库（`xlsx`、`exceljs`、`xlsx-populate`）。
- 生成启动模板 `main.js`，避免覆盖现有文件。
- 交互循环：反复提示输入 Excel 文件路径，执行 `bun run main.js`，并建议修改脚本以实现自定义逻辑。
- 错误处理：优雅捕获错误并清屏，提供干净的用户体验。
- 兼容性：适用于 Windows 系统，使用 PowerShell 7.5.4+，专注于本地离线执行。

## 先决条件
- Windows 操作系统（在 Windows 10/11 上测试通过）。
- PowerShell 7.5.4 或更高版本（从 [Microsoft 官方网站](https://learn.microsoft.com/zh-cn/powershell/scripting/install/installing-powershell-on-windows) 下载安装）。
- 初始安装需要互联网连接，用于下载 Bun 和 npm 包（设置完成后可离线使用）。

## 安装
1. **克隆仓库**：
   ```
   git clone https://github.com/yourusername/excel-automation-setup-bun.git
   cd excel-automation-setup-bun
   ```
   （替换 `yourusername` 为您的 GitHub 用户名。）

2. **运行脚本**：
   - 双击 `ExcelAutomationSetup.ps1` 文件（或在 PowerShell 中运行：`.\ExcelAutomationSetup.ps1`）。
   - 脚本会自动处理一切：安装 Bun、依赖库，并在需要时生成 `main.js`。

3. **自定义**：
   - 编辑 `main.js` 文件，添加您的 Excel 处理逻辑（例如读取工作表、修改数据）。
   - 重新运行脚本，以测试您的 Excel 文件。

## 使用方法
1. 双击或运行 `.ps1` 脚本。
2. 如果是首次运行：
   - 自动安装 Bun 和依赖库。
   - 创建模板 `main.js` 文件。
3. 当提示时，拖拽 Excel 文件（或粘贴其完整路径）。
4. 脚本会使用 `bun run main.js` 处理文件，并在控制台输出结果。
5. 处理完成后，提示：“处理完成，请手动重写main.js，并再次拖入EXCEL文件：”（处理完成，请手动重写 main.js，并再次拖入 Excel 文件）。
6. 留空路径以退出循环。
7. 完成后，按 Enter 关闭窗口。

### 示例输出
![脚本运行截图](https://via.placeholder.com/800x400?text=脚本运行截图)  
*(请替换为实际脚本运行的截图。)*

### 自定义 main.js
生成的 `main.js` 模板如下所示：
```javascript
import XLSX from 'xlsx';
import ExcelJS from 'exceljs';
import XlsxPopulate from 'xlsx-populate';

console.log('All libraries imported successfully!');

const filePath = process.argv[2]?.trim();
if (!filePath) {
    console.log('Usage: bun run main.js "C:\\path\\to\\your\\file.xlsx"');
    process.exit(1);
}

try {
    const workbook = XLSX.readFile(filePath);
    console.log(`SheetJS success! Sheets: ${workbook.SheetNames.join(', ')}`);
    
    // Example with ExcelJS: Load workbook
    const wb = new ExcelJS.Workbook();
    await wb.xlsx.readFile(filePath);
    console.log('ExcelJS loaded successfully.');
} catch (err) {
    console.error('Failed to process Excel file:', err.message);
}

console.log('请重写main.js脚本');
```

在此添加您的逻辑，例如数据提取、修改或导出。

## 依赖库
- [Bun](https://bun.sh/) - 快速 JavaScript 运行时。
- [xlsx](https://www.npmjs.com/package/xlsx) - Excel 解析/写入库（SheetJS）。
- [exceljs](https://www.npmjs.com/package/exceljs) - 高级 Excel 读写，支持样式。
- [xlsx-populate](https://www.npmjs.com/package/xlsx-populate) - 基于模板填充 Excel。

所有依赖由脚本自动安装。

## 贡献指南
欢迎贡献！请按照以下步骤操作：
1. Fork 该仓库。
2. 创建功能分支（`git checkout -b feature/YourFeature`）。
3. 提交更改（`git commit -m 'Add YourFeature'`）。
4. 推送分支（`git push origin feature/YourFeature`）。
5. 打开 Pull Request。

通过 [GitHub Issues](https://github.com/yourusername/excel-automation-setup-bun/issues) 报告问题或建议改进。

注意：本项目使用 GPLv3 许可证，因此所有贡献必须符合许可证条款。

## 许可证
本项目采用 GNU General Public License v3.0 - 详情见 [LICENSE](LICENSE) 文件。

## 致谢
- 灵感来源于 JavaScript Excel 自动化社区讨论。
- 感谢 Bun、xlsx、exceljs 和 xlsx-populate 的维护者。

---

如果您觉得有用，请 star 该仓库或分享！有问题？请打开 issue。